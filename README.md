# Petstore with gohandlers

## Reading files

- [`main.go`](main.go) demonstrates the usage of `ListHandlers` method with `http.ServeMux`.

- [`handlers/pets`](handlers/pets) directory contain the `Pets` struct and CRUD handlers defined on it. All files suffixed with `.gh.go` are autogenerated from the rest of directory files.

  - [`create.go`](handlers/pets/create.go), [`delete.go`](handlers/pets/delete.go), [`get.go`](handlers/pets/get.go) and [`list.go`](handlers/pets/list.go) shows the suggested format for handler files which contain one handler, its request binding type and optionally its response binding type.

  - [`bindings.gh.go`](handlers/pets/bindings.gh.go) contains `Build`, `Parse` and `Write` methods on request and response types. `request.Parse` and `response.Write` methods are meant to be used inside handlers. `request.Build` and `response.Parse` methods are used by the client code. Notice, each method respects `query`, `route` and `form` params. Thus generated methods choose the correct way to access values. Additionally methods use JSON encoder/decoder when one request/response body contain `json` tagged fields.

  - [`list.gh.go`](handlers/pets/list.gh.go) contains `ListHandlers` meant to be called by route registerer.

  - [`gh.yml`](handlers/pets/gh.yml) contains information of handler names, paths and methods that are meant help outside clients.

- [`client`](client) directory contain two files meant to be used by consumer of this service:

  - [`client.gh.go`](client/client.gh.go) contains CRUD methods on pets. Each accept one host url and request binding. They return response binding type, for handlers defines it. For others they return `http.Response` instance.

  - [`mock.gh.go`](client/mock.gh.go) contains an interface that the generated `Client` complies and a mock `Client` implementation that can be used by tests where calling the real service is not necessary.

- [`Makefile`](Makefile), [`handlers/Makefile`](handlers/Makefile), [`handlers/pets/Makefile`](handlers/pets/Makefile) shows the gohandlers commands and exact args used in generating this example.

## Output

```sh
$ go run .

registering ListPets as GET /pets
registering CreatePet as POST /create-pet
registering DeletePet as DELETE /pets/{id}
registering GetPet as GET /pets/{id}
```

## Re-generating files

```sh
make -B all
```

## See also

- [gohandlers](https://github.com/ufukty/gohandlers)
